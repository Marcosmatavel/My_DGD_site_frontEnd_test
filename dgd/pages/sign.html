<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
        <title>Sign in</title>
        <link rel="stylesheet" href="../styles/signIn_styles.css">
    </head>
    <body>
                <!-- Top Navigation -->
        <header>
            <nav id="nav-bar">
                <div id="logo">
                <a href="../index.html"><img src="#" alt="logo"></a>
                </div>
                <ul class="nav-links">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="materia.html">Materia</a></li>
                    <li><a href="exercises_ai.html">Exercise AI</a></li>
                    <li><a href="about_us.html">About us</a></li>
                    <li><a href="sign.html" class="active">Sign up</a></li>
                </ul>
                <div id="hamburger_menu">
                    <span class="line"></span>
                    <span class="line"></span>
                    <span class="line"></span>
                </div>
            </nav>
        </header>

        <div id="page_wrapper">
            <div id="big_container">
                <div id="log">
                    <h1>Log in</h1>
                    <form action="enter" method="get">
                        <label for="name_box">User name: 
                            <input type="text" name="name_box" id="name_box">
                        </label><br>
                        <label for="user_email">Email:
                            <input type="email" name="user_email" id="user_email">
                        </label><br>
                        <label for="user_password">Password:
                            <input type="password" name="user_password" id="user_password">
                        </label><br>
                        <button type="submit">Enter</button>
                    </form>
                </div>
                <hr>
                <div id="sign">
                    <h1>Register</h1>
                    <form action="register" method="post">
                        <label for="user_name">User name:
                            <input type="text" name="user_name" id="user_name" required>
                        </label><br>
                        <label for="user_email">Email:
                            <input type="email" name="user_email" id="user_email" required>
                        </label><br>
                        <label for="country_code">Country Code:</label>
                        <!-- country codes (ISO 3166) and Dial codes. -->
                        <se 
                        <br/><label>Cellphone number:</label>
                        <input type="text" name="cellphone_number" id="cellphone_number" required>

                        <label>Gender:</label><br>
                        <label for="male">Male</label>
                        <input type="radio" name="gender" value="Male" id="male"><br/>

                        <label for="female">Female</label>
                        <input type="radio" name="gender" value="Female" id="female"><br/>

                        <label for="no_gender">Rather not say</label>
                        <input type="radio" name="gender" value="No_gender" id="no_gender"><br/>

                        </label><br>
                        <label for="birthday">Birthday
                            <input type="date" name="birthday" id="birthday" required>
                        </label><br>
                        <label for="password">Password
                            <input type="password" name="password" id="password" required>
                        </label><br>
                        <label for="confirm_password">Confirm password
                            <input type="password" name="confirm_password" id="confirm_password" required>
                        </label><br>
                        <button type="submit">Register</button>
                    </form>
                </div>
            </div>
        </div>

        <!--================Scripts===========================-->
        <script src="../js/hamburger_menu.js"></script>
        <script>
            document.querySelector('form[action="enter"]').addEventListener("submit", function(e) {
                e.preventDefault();

                const username = document.getElementById("name_box");
                const email = document.getElementById("user_email");
                const password = document.getElementById("user_password");

                let valid = true;

                // Simple validation
                [username, email, password].forEach(field => {
                    if (!field.value.trim()) {
                        field.style.border = "2px solid red";
                        valid = false;
                    } else {
                        field.style.border = "1px solid #ccc";
                    }
                });

                // Basic email format check
                if (email.value && !/^\S+@\S+\.\S+$/.test(email.value)) {
                    email.style.border = "2px solid red";
                    valid = false;
                }

                if (!valid) {
                    // Shake animation
                    document.getElementById("log").classList.add("shake");
                    setTimeout(() => {
                        document.getElementById("log").classList.remove("shake");
                    }, 500);
                    return;
                }

                // Loading feedback
                const button = e.target.querySelector("button");
                button.innerText = "Loading...";
                button.disabled = true;

                setTimeout(() => {
                    alert("Logged in successfully! (Simulated)");
                    button.innerText = "Enter";
                    button.disabled = false;
                    e.target.reset();
                }, 2000);
            });
        </script>

        <script>
            document.querySelector('form[action="register"]').addEventListener("submit", function(e) {
                e.preventDefault();

                const form = e.target;
                const password = form.querySelector("#password").value;
                const confirmPassword = form.querySelector("#confirm_password").value;

                if (password !== confirmPassword) {
                    alert("Passwords do not match.");
                    return;
                }

                // Prepare form data
                const formData = new FormData(form);
                fetch("/api/register", {
                    method: "POST",
                    body: formData
                })
                .then(res => res.json())
                .then(data => {
                    alert(data.message);
                    if (data.success) form.reset();
                })
                .catch(() => alert("Registration failed. Try again later."));
            });
        </script>


    </body>
</html>